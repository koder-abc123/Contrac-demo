{"context":{},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}]}}
{"context":{"duration":{"Int":0},"sender":{"Principal":{"Standard":[26,[100,215,49,4,15,219,202,165,147,236,229,70,222,22,46,184,21,80,32,89]]}},"type":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"}]}}
{"context":{"duration":{"Int":0},"sender":{"Principal":{"Standard":[26,[100,215,49,4,15,219,202,165,147,236,229,70,222,22,46,184,21,80,32,89]]}},"type":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"}]}}
{"context":{"licensee":{"Principal":{"Standard":[26,[100,215,49,4,15,219,202,165,147,236,229,70,222,22,46,184,21,80,32,89]]}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"}]}}
{"context":{"duration":{"Int":0},"sender":{"Principal":{"Standard":[26,[100,215,49,4,15,219,202,165,147,236,229,70,222,22,46,184,21,80,32,89]]}},"type":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"}]}}
{"context":{"t":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"}]}}
{"context":{"t":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"_native_:special_match"}]}}
{"context":{"entry":{"Tuple":{"data_map":{"price":{"Int":100}},"type_signature":{"type_map":{"price":"IntType"}}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"_native_:special_match"}]}}
{"context":{"existing-license?":{"Optional":{"data":null}},"price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"}]}}
{"context":{"existing-license?":{"Optional":{"data":null}},"price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"}]}}
{"context":{"existing-license?":{"Optional":{"data":null}},"price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"}]}}
{"context":{"license-price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"}]}}
{"context":{"license-price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_stx_transfer"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_stx_transfer"}]}}
{"context":{},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_stx_transfer"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"},{"identifier":"_native_:special_set-entry"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"},{"identifier":"_native_:special_set-entry"},{"identifier":"_native_:native_add"}]}}
{"context":{},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"},{"identifier":"_native_:special_set-entry"},{"identifier":"_native_:native_add"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","licenser-address","price-list"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"}]}}
{"context":{},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}]}}
{"context":{"duration":{"Int":0},"sender":{"Principal":{"Standard":[26,[100,215,49,4,15,219,202,165,147,236,229,70,222,22,46,184,21,80,32,89]]}},"type":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"}]}}
{"context":{"duration":{"Int":0},"sender":{"Principal":{"Standard":[26,[100,215,49,4,15,219,202,165,147,236,229,70,222,22,46,184,21,80,32,89]]}},"type":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"}]}}
{"context":{"licensee":{"Principal":{"Standard":[26,[100,215,49,4,15,219,202,165,147,236,229,70,222,22,46,184,21,80,32,89]]}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"}]}}
{"context":{"duration":{"Int":0},"sender":{"Principal":{"Standard":[26,[100,215,49,4,15,219,202,165,147,236,229,70,222,22,46,184,21,80,32,89]]}},"type":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"}]}}
{"context":{"t":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"}]}}
{"context":{"t":{"Int":1}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"_native_:special_match"}]}}
{"context":{"entry":{"Tuple":{"data_map":{"price":{"Int":100}},"type_signature":{"type_map":{"price":"IntType"}}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},{"identifier":"_native_:special_match"}]}}
{"context":{"existing-license?":{"Optional":{"data":null}},"price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"}]}}
{"context":{"existing-license?":{"Optional":{"data":null}},"price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"}]}}
{"context":{"existing-license?":{"Optional":{"data":null}},"price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"}]}}
{"context":{"license-price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"}]}}
{"context":{"license-price":{"Int":100}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_stx_transfer"}]}}
{"context":{"buynow":{"Bool":true}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_stx_transfer"}]}}
{"context":{},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_stx_transfer"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"},{"identifier":"_native_:special_set-entry"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"},{"identifier":"_native_:special_set-entry"},{"identifier":"_native_:native_add"}]}}
{"context":{},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"},{"identifier":"_native_:special_set-entry"},{"identifier":"_native_:native_add"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"}]}}
{"context":{"transferred":{"Response":{"committed":true,"data":{"Bool":true}}}},"env":{"contract_identifier":{"issuer":[26,[210,137,135,159,210,247,227,61,194,243,163,67,70,194,6,243,93,231,54,150]],"name":"oi-license"},"data_size":85,"defined_traits":{},"functions":{"buy":{"arg_types":["IntType","IntType","PrincipalType"],"arguments":["type","duration","sender"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":247,"span":{"end_column":6,"end_line":73,"start_column":4,"start_line":73}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"existing-license?"},"id":250,"span":{"end_column":26,"end_line":73,"start_column":10,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":252,"span":{"end_column":40,"end_line":73,"start_column":29,"start_line":73}},{"expr":{"Atom":"sender"},"id":253,"span":{"end_column":47,"end_line":73,"start_column":42,"start_line":73}}]},"id":251,"span":{"end_column":48,"end_line":73,"start_column":28,"start_line":73}}]},"id":249,"span":{"end_column":49,"end_line":73,"start_column":9,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"price"},"id":255,"span":{"end_column":15,"end_line":74,"start_column":11,"start_line":74}},{"expr":{"List":[{"expr":{"Atom":"get-price"},"id":257,"span":{"end_column":26,"end_line":74,"start_column":18,"start_line":74}},{"expr":{"Atom":"type"},"id":258,"span":{"end_column":31,"end_line":74,"start_column":28,"start_line":74}}]},"id":256,"span":{"end_column":32,"end_line":74,"start_column":17,"start_line":74}}]},"id":254,"span":{"end_column":33,"end_line":74,"start_column":10,"start_line":74}}]},"id":248,"span":{"end_column":34,"end_line":74,"start_column":8,"start_line":73}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":260,"span":{"end_column":8,"end_line":75,"start_column":6,"start_line":75}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-price"},"id":263,"span":{"end_column":24,"end_line":75,"start_column":12,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":265,"span":{"end_column":11,"end_line":76,"start_column":10,"start_line":76}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":267,"span":{"end_column":18,"end_line":76,"start_column":14,"start_line":76}},{"expr":{"Atom":"type"},"id":268,"span":{"end_column":23,"end_line":76,"start_column":20,"start_line":76}},{"expr":{"LiteralValue":{"Int":1}},"id":269,"span":{"end_column":25,"end_line":76,"start_column":25,"start_line":76}}]},"id":266,"span":{"end_column":26,"end_line":76,"start_column":13,"start_line":76}},{"expr":{"Atom":"price"},"id":270,"span":{"end_column":15,"end_line":77,"start_column":11,"start_line":77}},{"expr":{"List":[{"expr":{"Atom":"*"},"id":272,"span":{"end_column":12,"end_line":78,"start_column":12,"start_line":78}},{"expr":{"Atom":"price"},"id":273,"span":{"end_column":18,"end_line":78,"start_column":14,"start_line":78}},{"expr":{"Atom":"duration"},"id":274,"span":{"end_column":27,"end_line":78,"start_column":20,"start_line":78}}]},"id":271,"span":{"end_column":28,"end_line":78,"start_column":11,"start_line":78}}]},"id":264,"span":{"end_column":29,"end_line":78,"start_column":9,"start_line":76}}]},"id":262,"span":{"end_column":30,"end_line":78,"start_column":11,"start_line":75}}]},"id":261,"span":{"end_column":31,"end_line":78,"start_column":10,"start_line":75}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":276,"span":{"end_column":10,"end_line":79,"start_column":8,"start_line":79}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"buynow"},"id":279,"span":{"end_column":16,"end_line":80,"start_column":11,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"match"},"id":281,"span":{"end_column":23,"end_line":80,"start_column":19,"start_line":80}},{"expr":{"Atom":"existing-license?"},"id":282,"span":{"end_column":41,"end_line":80,"start_column":25,"start_line":80}},{"expr":{"Atom":"license"},"id":283,"span":{"end_column":17,"end_line":81,"start_column":11,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"print"},"id":285,"span":{"end_column":24,"end_line":81,"start_column":20,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"should-buy"},"id":287,"span":{"end_column":36,"end_line":81,"start_column":27,"start_line":81}},{"expr":{"Atom":"type"},"id":288,"span":{"end_column":41,"end_line":81,"start_column":38,"start_line":81}},{"expr":{"Atom":"duration"},"id":289,"span":{"end_column":50,"end_line":81,"start_column":43,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":291,"span":{"end_column":55,"end_line":81,"start_column":53,"start_line":81}},{"expr":{"Atom":"type"},"id":292,"span":{"end_column":60,"end_line":81,"start_column":57,"start_line":81}},{"expr":{"Atom":"license"},"id":293,"span":{"end_column":68,"end_line":81,"start_column":62,"start_line":81}}]},"id":290,"span":{"end_column":69,"end_line":81,"start_column":52,"start_line":81}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":295,"span":{"end_column":74,"end_line":81,"start_column":72,"start_line":81}},{"expr":{"Atom":"block"},"id":296,"span":{"end_column":80,"end_line":81,"start_column":76,"start_line":81}},{"expr":{"Atom":"license"},"id":297,"span":{"end_column":88,"end_line":81,"start_column":82,"start_line":81}}]},"id":294,"span":{"end_column":89,"end_line":81,"start_column":71,"start_line":81}}]},"id":286,"span":{"end_column":90,"end_line":81,"start_column":26,"start_line":81}}]},"id":284,"span":{"end_column":91,"end_line":81,"start_column":19,"start_line":81}},{"expr":{"Atom":"true"},"id":298,"span":{"end_column":14,"end_line":82,"start_column":11,"start_line":82}}]},"id":280,"span":{"end_column":15,"end_line":82,"start_column":18,"start_line":80}}]},"id":278,"span":{"end_column":16,"end_line":82,"start_column":10,"start_line":80}}]},"id":277,"span":{"end_column":17,"end_line":82,"start_column":9,"start_line":80}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":300,"span":{"end_column":11,"end_line":83,"start_column":10,"start_line":83}},{"expr":{"Atom":"buynow"},"id":301,"span":{"end_column":18,"end_line":83,"start_column":13,"start_line":83}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":303,"span":{"end_column":14,"end_line":84,"start_column":12,"start_line":84}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"transferred"},"id":306,"span":{"end_column":28,"end_line":84,"start_column":18,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"stx-transfer?"},"id":308,"span":{"end_column":43,"end_line":84,"start_column":31,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"to-uint"},"id":310,"span":{"end_column":52,"end_line":84,"start_column":46,"start_line":84}},{"expr":{"Atom":"license-price"},"id":311,"span":{"end_column":66,"end_line":84,"start_column":54,"start_line":84}}]},"id":309,"span":{"end_column":67,"end_line":84,"start_column":45,"start_line":84}},{"expr":{"Atom":"tx-sender"},"id":312,"span":{"end_column":77,"end_line":84,"start_column":69,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"get-licenser"},"id":314,"span":{"end_column":91,"end_line":84,"start_column":80,"start_line":84}}]},"id":313,"span":{"end_column":92,"end_line":84,"start_column":79,"start_line":84}}]},"id":307,"span":{"end_column":93,"end_line":84,"start_column":30,"start_line":84}}]},"id":305,"span":{"end_column":94,"end_line":84,"start_column":17,"start_line":84}}]},"id":304,"span":{"end_column":95,"end_line":84,"start_column":16,"start_line":84}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":316,"span":{"end_column":15,"end_line":85,"start_column":14,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"is-ok"},"id":318,"span":{"end_column":22,"end_line":85,"start_column":18,"start_line":85}},{"expr":{"Atom":"transferred"},"id":319,"span":{"end_column":34,"end_line":85,"start_column":24,"start_line":85}}]},"id":317,"span":{"end_column":35,"end_line":85,"start_column":17,"start_line":85}},{"expr":{"List":[{"expr":{"Atom":"begin"},"id":321,"span":{"end_column":20,"end_line":86,"start_column":16,"start_line":86}},{"expr":{"List":[{"expr":{"Atom":"map-set"},"id":323,"span":{"end_column":24,"end_line":87,"start_column":18,"start_line":87}},{"expr":{"Atom":"licenses"},"id":324,"span":{"end_column":33,"end_line":87,"start_column":26,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":327,"span":{"end_column":44,"end_line":87,"start_column":37,"start_line":87}},{"expr":{"Atom":"sender"},"id":328,"span":{"end_column":51,"end_line":87,"start_column":46,"start_line":87}}]},"id":326,"span":{"end_column":52,"end_line":87,"start_column":36,"start_line":87}}]},"id":325,"span":{"end_column":53,"end_line":87,"start_column":35,"start_line":87}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":331,"span":{"end_column":24,"end_line":88,"start_column":21,"start_line":88}},{"expr":{"Atom":"type"},"id":332,"span":{"end_column":29,"end_line":88,"start_column":26,"start_line":88}}]},"id":330,"span":{"end_column":30,"end_line":88,"start_column":20,"start_line":88}},{"expr":{"List":[{"expr":{"Atom":"block"},"id":334,"span":{"end_column":24,"end_line":89,"start_column":20,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"+"},"id":336,"span":{"end_column":27,"end_line":89,"start_column":27,"start_line":89}},{"expr":{"Atom":"duration"},"id":337,"span":{"end_column":36,"end_line":89,"start_column":29,"start_line":89}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":339,"span":{"end_column":54,"end_line":89,"start_column":39,"start_line":89}}]},"id":338,"span":{"end_column":55,"end_line":89,"start_column":38,"start_line":89}}]},"id":335,"span":{"end_column":56,"end_line":89,"start_column":26,"start_line":89}}]},"id":333,"span":{"end_column":57,"end_line":89,"start_column":19,"start_line":89}}]},"id":329,"span":{"end_column":58,"end_line":89,"start_column":19,"start_line":88}}]},"id":322,"span":{"end_column":19,"end_line":90,"start_column":17,"start_line":87}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":341,"span":{"end_column":19,"end_line":91,"start_column":18,"start_line":91}},{"expr":{"Atom":"license-price"},"id":342,"span":{"end_column":33,"end_line":91,"start_column":21,"start_line":91}}]},"id":340,"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91}}]},"id":320,"span":{"end_column":35,"end_line":91,"start_column":15,"start_line":86}},{"expr":{"Atom":"payment-err"},"id":343,"span":{"end_column":25,"end_line":92,"start_column":15,"start_line":92}}]},"id":315,"span":{"end_column":26,"end_line":92,"start_column":13,"start_line":85}}]},"id":302,"span":{"end_column":11,"end_line":93,"start_column":11,"start_line":84}},{"expr":{"Atom":"license-exists-err"},"id":344,"span":{"end_column":28,"end_line":94,"start_column":11,"start_line":94}}]},"id":299,"span":{"end_column":29,"end_line":94,"start_column":9,"start_line":83}}]},"id":275,"span":{"end_column":3,"end_line":95,"start_column":7,"start_line":79}}]},"id":259,"span":{"end_column":4,"end_line":95,"start_column":5,"start_line":75}}]},"id":246,"span":{"end_column":5,"end_line":95,"start_column":3,"start_line":73}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},"name":"buy"},"buy-expiring":{"arg_types":["IntType"],"arguments":["duration"],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":362,"span":{"end_column":6,"end_line":103,"start_column":4,"start_line":103}},{"expr":{"LiteralValue":{"Int":2}},"id":363,"span":{"end_column":8,"end_line":103,"start_column":8,"start_line":103}},{"expr":{"Atom":"duration"},"id":364,"span":{"end_column":17,"end_line":103,"start_column":10,"start_line":103}},{"expr":{"Atom":"tx-sender"},"id":365,"span":{"end_column":27,"end_line":103,"start_column":19,"start_line":103}}]},"id":361,"span":{"end_column":28,"end_line":103,"start_column":3,"start_line":103}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-expiring"},"name":"buy-expiring"},"buy-non-expiring":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"buy"},"id":350,"span":{"end_column":6,"end_line":99,"start_column":4,"start_line":99}},{"expr":{"LiteralValue":{"Int":1}},"id":351,"span":{"end_column":8,"end_line":99,"start_column":8,"start_line":99}},{"expr":{"LiteralValue":{"Int":0}},"id":352,"span":{"end_column":10,"end_line":99,"start_column":10,"start_line":99}},{"expr":{"Atom":"tx-sender"},"id":353,"span":{"end_column":20,"end_line":99,"start_column":12,"start_line":99}}]},"id":349,"span":{"end_column":21,"end_line":99,"start_column":3,"start_line":99}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},"name":"buy-non-expiring"},"get-block-height":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"to-int"},"id":109,"span":{"end_column":9,"end_line":33,"start_column":4,"start_line":33}},{"expr":{"Atom":"block-height"},"id":110,"span":{"end_column":22,"end_line":33,"start_column":11,"start_line":33}}]},"id":108,"span":{"end_column":23,"end_line":33,"start_column":3,"start_line":33}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-block-height"},"name":"get-block-height"},"get-license?":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":98,"span":{"end_column":10,"end_line":29,"start_column":3,"start_line":29}},{"expr":{"Atom":"licenses"},"id":99,"span":{"end_column":19,"end_line":29,"start_column":12,"start_line":29}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"licensee"},"id":102,"span":{"end_column":30,"end_line":29,"start_column":23,"start_line":29}},{"expr":{"Atom":"licensee"},"id":103,"span":{"end_column":39,"end_line":29,"start_column":32,"start_line":29}}]},"id":101,"span":{"end_column":40,"end_line":29,"start_column":22,"start_line":29}}]},"id":100,"span":{"end_column":41,"end_line":29,"start_column":21,"start_line":29}}]},"id":97,"span":{"end_column":42,"end_line":29,"start_column":2,"start_line":29}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-license?"},"name":"get-license?"},"get-licenser":{"arg_types":[],"arguments":[],"body":{"expr":{"List":[{"expr":{"Atom":"var-get"},"id":66,"span":{"end_column":10,"end_line":18,"start_column":4,"start_line":18}},{"expr":{"Atom":"licenser-address"},"id":67,"span":{"end_column":27,"end_line":18,"start_column":12,"start_line":18}}]},"id":65,"span":{"end_column":28,"end_line":18,"start_column":3,"start_line":18}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-licenser"},"name":"get-licenser"},"get-price":{"arg_types":["IntType"],"arguments":["t"],"body":{"expr":{"List":[{"expr":{"Atom":"match"},"id":76,"span":{"end_column":8,"end_line":22,"start_column":4,"start_line":22}},{"expr":{"List":[{"expr":{"Atom":"map-get?"},"id":78,"span":{"end_column":18,"end_line":22,"start_column":11,"start_line":22}},{"expr":{"Atom":"price-list"},"id":79,"span":{"end_column":29,"end_line":22,"start_column":20,"start_line":22}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"type"},"id":82,"span":{"end_column":36,"end_line":22,"start_column":33,"start_line":22}},{"expr":{"Atom":"t"},"id":83,"span":{"end_column":38,"end_line":22,"start_column":38,"start_line":22}}]},"id":81,"span":{"end_column":39,"end_line":22,"start_column":32,"start_line":22}}]},"id":80,"span":{"end_column":40,"end_line":22,"start_column":31,"start_line":22}}]},"id":77,"span":{"end_column":41,"end_line":22,"start_column":10,"start_line":22}},{"expr":{"Atom":"entry"},"id":84,"span":{"end_column":9,"end_line":23,"start_column":5,"start_line":23}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":86,"span":{"end_column":14,"end_line":23,"start_column":12,"start_line":23}},{"expr":{"Atom":"price"},"id":87,"span":{"end_column":20,"end_line":23,"start_column":16,"start_line":23}},{"expr":{"Atom":"entry"},"id":88,"span":{"end_column":26,"end_line":23,"start_column":22,"start_line":23}}]},"id":85,"span":{"end_column":27,"end_line":23,"start_column":11,"start_line":23}},{"expr":{"LiteralValue":{"Int":0}},"id":89,"span":{"end_column":5,"end_line":24,"start_column":5,"start_line":24}}]},"id":75,"span":{"end_column":3,"end_line":25,"start_column":3,"start_line":22}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:get-price"},"name":"get-price"},"has-valid-license":{"arg_types":["PrincipalType"],"arguments":["licensee"],"body":{"expr":{"List":[{"expr":{"Atom":"let"},"id":119,"span":{"end_column":6,"end_line":37,"start_column":4,"start_line":37}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"when"},"id":122,"span":{"end_column":8,"end_line":38,"start_column":5,"start_line":38}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":124,"span":{"end_column":26,"end_line":38,"start_column":11,"start_line":38}}]},"id":123,"span":{"end_column":27,"end_line":38,"start_column":10,"start_line":38}}]},"id":121,"span":{"end_column":28,"end_line":38,"start_column":9,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"license"},"id":126,"span":{"end_column":12,"end_line":39,"start_column":6,"start_line":39}},{"expr":{"List":[{"expr":{"Atom":"get-license?"},"id":128,"span":{"end_column":26,"end_line":39,"start_column":15,"start_line":39}},{"expr":{"Atom":"licensee"},"id":129,"span":{"end_column":35,"end_line":39,"start_column":28,"start_line":39}}]},"id":127,"span":{"end_column":36,"end_line":39,"start_column":14,"start_line":39}}]},"id":125,"span":{"end_column":37,"end_line":39,"start_column":5,"start_line":39}}]},"id":120,"span":{"end_column":38,"end_line":39,"start_column":8,"start_line":37}},{"expr":{"List":[{"expr":{"Atom":"let"},"id":131,"span":{"end_column":8,"end_line":40,"start_column":6,"start_line":40}},{"expr":{"List":[{"expr":{"List":[{"expr":{"Atom":"license-type"},"id":134,"span":{"end_column":23,"end_line":40,"start_column":12,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":136,"span":{"end_column":35,"end_line":40,"start_column":26,"start_line":40}},{"expr":{"LiteralValue":{"Int":0}},"id":137,"span":{"end_column":37,"end_line":40,"start_column":37,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":139,"span":{"end_column":42,"end_line":40,"start_column":40,"start_line":40}},{"expr":{"Atom":"type"},"id":140,"span":{"end_column":47,"end_line":40,"start_column":44,"start_line":40}},{"expr":{"Atom":"license"},"id":141,"span":{"end_column":55,"end_line":40,"start_column":49,"start_line":40}}]},"id":138,"span":{"end_column":56,"end_line":40,"start_column":39,"start_line":40}}]},"id":135,"span":{"end_column":57,"end_line":40,"start_column":25,"start_line":40}}]},"id":133,"span":{"end_column":58,"end_line":40,"start_column":11,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"license-block"},"id":143,"span":{"end_column":20,"end_line":41,"start_column":8,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"default-to"},"id":145,"span":{"end_column":32,"end_line":41,"start_column":23,"start_line":41}},{"expr":{"LiteralValue":{"Int":0}},"id":146,"span":{"end_column":34,"end_line":41,"start_column":34,"start_line":41}},{"expr":{"List":[{"expr":{"Atom":"get"},"id":148,"span":{"end_column":39,"end_line":41,"start_column":37,"start_line":41}},{"expr":{"Atom":"block"},"id":149,"span":{"end_column":45,"end_line":41,"start_column":41,"start_line":41}},{"expr":{"Atom":"license"},"id":150,"span":{"end_column":53,"end_line":41,"start_column":47,"start_line":41}}]},"id":147,"span":{"end_column":54,"end_line":41,"start_column":36,"start_line":41}}]},"id":144,"span":{"end_column":55,"end_line":41,"start_column":22,"start_line":41}}]},"id":142,"span":{"end_column":56,"end_line":41,"start_column":7,"start_line":41}}]},"id":132,"span":{"end_column":57,"end_line":41,"start_column":10,"start_line":40}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":152,"span":{"end_column":9,"end_line":42,"start_column":8,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":154,"span":{"end_column":16,"end_line":42,"start_column":12,"start_line":42}},{"expr":{"Atom":"license-type"},"id":155,"span":{"end_column":29,"end_line":42,"start_column":18,"start_line":42}},{"expr":{"LiteralValue":{"Int":0}},"id":156,"span":{"end_column":31,"end_line":42,"start_column":31,"start_line":42}}]},"id":153,"span":{"end_column":32,"end_line":42,"start_column":11,"start_line":42}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":158,"span":{"end_column":11,"end_line":43,"start_column":10,"start_line":43}},{"expr":{"Atom":"false"},"id":159,"span":{"end_column":17,"end_line":43,"start_column":13,"start_line":43}}]},"id":157,"span":{"end_column":18,"end_line":43,"start_column":9,"start_line":43}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":161,"span":{"end_column":11,"end_line":44,"start_column":10,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":163,"span":{"end_column":18,"end_line":44,"start_column":14,"start_line":44}},{"expr":{"Atom":"license-type"},"id":164,"span":{"end_column":32,"end_line":44,"start_column":21,"start_line":44}},{"expr":{"LiteralValue":{"Int":1}},"id":165,"span":{"end_column":34,"end_line":44,"start_column":34,"start_line":44}}]},"id":162,"span":{"end_column":35,"end_line":44,"start_column":13,"start_line":44}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":167,"span":{"end_column":13,"end_line":45,"start_column":12,"start_line":45}},{"expr":{"Atom":"true"},"id":168,"span":{"end_column":18,"end_line":45,"start_column":15,"start_line":45}}]},"id":166,"span":{"end_column":19,"end_line":45,"start_column":11,"start_line":45}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":170,"span":{"end_column":13,"end_line":46,"start_column":12,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":172,"span":{"end_column":20,"end_line":46,"start_column":16,"start_line":46}},{"expr":{"Atom":"license-type"},"id":173,"span":{"end_column":33,"end_line":46,"start_column":22,"start_line":46}},{"expr":{"LiteralValue":{"Int":2}},"id":174,"span":{"end_column":35,"end_line":46,"start_column":35,"start_line":46}}]},"id":171,"span":{"end_column":36,"end_line":46,"start_column":15,"start_line":46}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":176,"span":{"end_column":15,"end_line":47,"start_column":14,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":178,"span":{"end_column":18,"end_line":47,"start_column":18,"start_line":47}},{"expr":{"Atom":"when"},"id":179,"span":{"end_column":23,"end_line":47,"start_column":20,"start_line":47}},{"expr":{"Atom":"license-block"},"id":180,"span":{"end_column":37,"end_line":47,"start_column":25,"start_line":47}}]},"id":177,"span":{"end_column":38,"end_line":47,"start_column":17,"start_line":47}}]},"id":175,"span":{"end_column":39,"end_line":47,"start_column":13,"start_line":47}},{"expr":{"List":[{"expr":{"Atom":"ok"},"id":182,"span":{"end_column":15,"end_line":48,"start_column":14,"start_line":48}},{"expr":{"Atom":"false"},"id":183,"span":{"end_column":21,"end_line":48,"start_column":17,"start_line":48}}]},"id":181,"span":{"end_column":22,"end_line":48,"start_column":13,"start_line":48}}]},"id":169,"span":{"end_column":11,"end_line":49,"start_column":11,"start_line":46}}]},"id":160,"span":{"end_column":9,"end_line":50,"start_column":9,"start_line":44}}]},"id":151,"span":{"end_column":7,"end_line":51,"start_column":7,"start_line":42}}]},"id":130,"span":{"end_column":5,"end_line":52,"start_column":5,"start_line":40}}]},"id":118,"span":{"end_column":3,"end_line":53,"start_column":3,"start_line":37}},"define_type":"Public","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:has-valid-license"},"name":"has-valid-license"},"should-buy":{"arg_types":["IntType","IntType","IntType","IntType"],"arguments":["type","duration","existing-type","existing-block"],"body":{"expr":{"List":[{"expr":{"Atom":"if"},"id":201,"span":{"end_column":7,"end_line":57,"start_column":6,"start_line":57}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":203,"span":{"end_column":14,"end_line":57,"start_column":10,"start_line":57}},{"expr":{"Atom":"existing-type"},"id":204,"span":{"end_column":28,"end_line":57,"start_column":16,"start_line":57}},{"expr":{"LiteralValue":{"Int":1}},"id":205,"span":{"end_column":30,"end_line":57,"start_column":30,"start_line":57}}]},"id":202,"span":{"end_column":31,"end_line":57,"start_column":9,"start_line":57}},{"expr":{"Atom":"false"},"id":206,"span":{"end_column":11,"end_line":58,"start_column":7,"start_line":58}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":208,"span":{"end_column":9,"end_line":59,"start_column":8,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":210,"span":{"end_column":16,"end_line":59,"start_column":12,"start_line":59}},{"expr":{"Atom":"existing-type"},"id":211,"span":{"end_column":30,"end_line":59,"start_column":18,"start_line":59}},{"expr":{"LiteralValue":{"Int":2}},"id":212,"span":{"end_column":32,"end_line":59,"start_column":32,"start_line":59}}]},"id":209,"span":{"end_column":33,"end_line":59,"start_column":11,"start_line":59}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":214,"span":{"end_column":11,"end_line":60,"start_column":10,"start_line":60}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":216,"span":{"end_column":18,"end_line":60,"start_column":14,"start_line":60}},{"expr":{"Atom":"type"},"id":217,"span":{"end_column":23,"end_line":60,"start_column":20,"start_line":60}},{"expr":{"LiteralValue":{"Int":1}},"id":218,"span":{"end_column":25,"end_line":60,"start_column":25,"start_line":60}}]},"id":215,"span":{"end_column":26,"end_line":60,"start_column":13,"start_line":60}},{"expr":{"Atom":"true"},"id":219,"span":{"end_column":14,"end_line":61,"start_column":11,"start_line":61}},{"expr":{"List":[{"expr":{"Atom":"if"},"id":221,"span":{"end_column":13,"end_line":62,"start_column":12,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"is-eq"},"id":223,"span":{"end_column":20,"end_line":62,"start_column":16,"start_line":62}},{"expr":{"Atom":"type"},"id":224,"span":{"end_column":25,"end_line":62,"start_column":22,"start_line":62}},{"expr":{"LiteralValue":{"Int":2}},"id":225,"span":{"end_column":27,"end_line":62,"start_column":27,"start_line":62}}]},"id":222,"span":{"end_column":28,"end_line":62,"start_column":15,"start_line":62}},{"expr":{"List":[{"expr":{"Atom":"<"},"id":227,"span":{"end_column":14,"end_line":63,"start_column":14,"start_line":63}},{"expr":{"Atom":"existing-block"},"id":228,"span":{"end_column":29,"end_line":63,"start_column":16,"start_line":63}},{"expr":{"List":[{"expr":{"Atom":"get-block-height"},"id":230,"span":{"end_column":47,"end_line":63,"start_column":32,"start_line":63}}]},"id":229,"span":{"end_column":48,"end_line":63,"start_column":31,"start_line":63}}]},"id":226,"span":{"end_column":49,"end_line":63,"start_column":13,"start_line":63}},{"expr":{"Atom":"true"},"id":231,"span":{"end_column":16,"end_line":64,"start_column":13,"start_line":64}}]},"id":220,"span":{"end_column":11,"end_line":65,"start_column":11,"start_line":62}}]},"id":213,"span":{"end_column":9,"end_line":66,"start_column":9,"start_line":60}},{"expr":{"Atom":"true"},"id":232,"span":{"end_column":12,"end_line":67,"start_column":9,"start_line":67}}]},"id":207,"span":{"end_column":7,"end_line":68,"start_column":7,"start_line":59}}]},"id":200,"span":{"end_column":3,"end_line":69,"start_column":5,"start_line":57}},"define_type":"Private","identifier":{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:should-buy"},"name":"should-buy"}},"implemented_traits":[],"persisted_names":["licenses","price-list","licenser-address"],"variables":{"invalid-license-type-err":{"Response":{"committed":false,"data":{"Int":2}}},"license-exists-err":{"Response":{"committed":false,"data":{"Int":5}}},"licenser-already-set-err":{"Response":{"committed":false,"data":{"Int":1}}},"missing-licenser-err":{"Response":{"committed":false,"data":{"Int":3}}},"payment-err":{"Response":{"committed":false,"data":{"Int":4}}}}},"span":{"end_column":34,"end_line":91,"start_column":17,"start_line":91},"stack":{"set":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"}],"stack":[{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy-non-expiring"},{"identifier":"ST398K1WZTBVY6FE2YEHM6HP20VSNVSSPJTW0D53M.oi-license:buy"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:special_let"},{"identifier":"_native_:special_if"},{"identifier":"_native_:native_begin"}]}}
